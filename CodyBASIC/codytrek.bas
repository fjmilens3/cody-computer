10 REM CODYTREK 1.0 BY F.J. MILENS III
20 REM RELEASED UNDER GPL V3, DEC 2024
30 GOSUB 2400
40 PRINT AT(0,12),CHR$(241)
50 PRINT "ENTER GAME NUMBER";
60 INPUT I
70 S(0)=MOD(RND(I),10)+10
80 S(1)=MOD(RND(),2)+2
90 S(2)=MOD(RND(),64)
100 S(3)=MOD(RND(),64)
110 S(4)=3000
120 S(5)=0
130 S(6)=0
140 S(7)=0
150 S(8)=S(0)
160 S(9)=S(1)
170 S(10)=1
180 GOSUB 1000
190 GOSUB 1500
200 GOSUB 3000
210 PRINT AT(0,20),CHR$(252);
220 PRINT "PRESS ENTER TO CONTINUE";
230 INPUT C$
240 GOSUB 2200
300 REM MAIN LOOP
310 IF S(10)=0 THEN GOTO 400
320 GOSUB 5900
330 IF S(10)=0 THEN GOTO 400
340 GOSUB 3400
350 GOTO 310
400 REM END OF GAME
410 GOSUB 2400
420 PRINT AT(0,12),CHR$(241)
430 GOSUB 5800
440 PRINT CHR$(241),"PLAY AGAIN (Y/N)";
450 INPUT C$
460 IF C$="Y" THEN GOTO 10
470 IF C$="N" THEN END
480 GOTO 400
1000 REM GENERATE GALAXY
1010 FOR I=0 TO 63
1020 G(I)=MOD(RND(),5)+1
1030 NEXT
1040 FOR N=0 TO S(1)-1
1050 GOSUB 1150
1060 IF G(I)/10>1 THEN GOTO 1050
1070 G(I)=G(I)+10
1080 NEXT
1090 FOR N=0 TO S(0)-1
1100 GOSUB 1150
1110 IF G(I)/100>5 THEN GOTO 1100
1120 G(I)=G(I)+100
1130 NEXT
1140 RETURN
1150 X=MOD(RND(),8)
1160 Y=MOD(RND(),8)
1170 I=X+Y*8
1180 RETURN
1200 REM QUADRANT NAME
1210 I=S(2)/8+S(3)/8*8
1220 T=I/4
1230 IF T=0 THEN S$="ANTARES"
1240 IF T=1 THEN S$="SIRIUS"
1250 IF T=2 THEN S$="RIGEL"
1260 IF T=3 THEN S$="DENEB"
1270 IF T=4 THEN S$="PROCYON"
1280 IF T=5 THEN S$="CAPELLA"
1290 IF T=6 THEN S$="VEGA"
1300 IF T=7 THEN S$="BETELGEUSE"
1310 IF T=8 THEN S$="CANOPUS"
1320 IF T=9 THEN S$="ALDEBARAN"
1330 IF T=10 THEN S$="ALTAIR"
1340 IF T=11 THEN S$="REGULUS"
1350 IF T=12 THEN S$="SAGITTARIUS"
1360 IF T=13 THEN S$="ARCTURUS"
1370 IF T=14 THEN S$="POLLUX"
1380 IF T=15 THEN S$="SPICA"
1390 T=MOD(I,4)
1400 IF T=0 THEN S$=S$+" I"
1410 IF T=1 THEN S$=S$+" II"
1420 IF T=2 THEN S$=S$+" III"
1430 IF T=3 THEN S$=S$+" IV"
1440 RETURN
1500 REM GENERATE QUADRANT
1510 FOR N=0 TO 63
1520 Q(N)=0
1530 NEXT
1540 X=MOD(S(2),8)
1550 Y=MOD(S(3),8)
1560 Q(X+Y*8)=4000
1570 T=G(S(2)/8+S(3)/8*8)
1580 D=100
1590 FOR J=0 TO 2
1600 C=T/D
1610 IF C=0 THEN GOTO 1720
1620 FOR K=0 TO C-1
1630 X=MOD(RND(),8)
1640 Y=MOD(RND(),8)
1650 I=X+Y*8
1660 IF Q(I)>0 THEN GOTO 1630
1670 Q(I)=(J+1)*1000
1680 IF J=0 THEN Q(I)=Q(I)+250+RND()
1690 IF J=1 THEN Q(I)=Q(I)+999
1700 IF J=2 THEN Q(I)=Q(I)+999
1710 NEXT
1720 T=T-C*D
1730 D=D/10
1740 NEXT
1750 RETURN
1800 REM DRAW GRID
1810 PRINT CHR$(252);
1820 FOR X=0 TO 7
1830 PRINT AT(4+X*4,2),X;
1840 NEXT
1850 FOR Y=0 TO 7
1860 PRINT AT(1,4+Y*2),Y;
1870 NEXT
1880 RETURN
1900 REM LONG RANGE SCAN
1910 PRINT CHR$(224,241,222,253);
1920 GOSUB 1800
1930 PRINT AT(0,0),CHR$(253);
1940 PRINT "LONG RANGE SCAN (",S(2)/8,",",S(3)/8,")";
1950 FOR Y=0 TO 7
1960 FOR X=0 TO 7
1970 PRINT AT(3+X*4,4+Y*2),CHR$(247);
1980 D=G(X+Y*8)
1990 C=D/100
2000 D=D-C*100
2010 IF C>0 THEN PRINT CHR$(250);
2020 PRINT C,CHR$(247);
2030 C=D/10
2040 D=D-C*10
2050 IF C>0 THEN PRINT CHR$(255);
2060 PRINT C,CHR$(247);
2070 PRINT D
2080 NEXT
2090 NEXT
2100 GOSUB 2700
2110 RETURN
2200 REM SHORT RANGE SCAN
2210 PRINT CHR$(224,241,222,253);
2220 IF G(S(2)/8+S(3)/8*8)/100>0 THEN PRINT CHR$(250);
2230 GOSUB 1200
2240 PRINT S$," (",S(2)/8,",",S(3)/8,")";
2250 GOSUB 1800
2260 FOR Y=0 TO 7
2270 FOR X=0 TO 7
2280 PRINT AT(3+X*4,4+Y*2);
2290 T=Q(X+Y*8)/1000
2300 IF T=0 THEN PRINT CHR$(251),"...";
2310 IF T=1 THEN PRINT CHR$(253,191,135,165);
2320 IF T=2 THEN PRINT CHR$(255,180,165,180);
2330 IF T=3 THEN PRINT CHR$(247,32,148,32);
2340 IF T=4 THEN PRINT CHR$(241,134,165,135);
2350 NEXT
2360 NEXT
2370 GOSUB 2700
2380 RETURN
2400 REM TITLE SCREEN
2410 POKE 53250,AND(PEEK(53250),240)
2420 PRINT CHR$(224,241,222);
2430 FOR I=0 TO 30
2440 PRINT AT(MOD(RND(),40),MOD(RND(),12)),".";
2450 NEXT
2460 A$="CODYTREK"
2470 X=3
2480 Y=1
2490 PRINT CHR$(231,241);
2500 FOR N=0 TO LEN(A$)-1
2510 B$=SUB$(A$,N,1)
2520 C=ASC(B$)
2530 FOR J=0 TO 7
2540 R=PEEK(C*8+57344+J)
2550 FOR I=0 TO 3
2560 IF AND(R,192)>0 THEN PRINT AT(X+I,Y+J)," ";
2570 R=AND(R*4,255)
2580 NEXT
2590 NEXT
2600 X=X+4
2610 IF N=3 THEN Y=Y+2
2620 NEXT
2630 PRINT CHR$(224,241),AT(0,12)
2640 RETURN
2700 REM STATUS DISPLAY
2710 PRINT AT(35,2),CHR$(252),"DATE",CHR$(247),AT(35,3);
2720 N=S(7)
2730 GOSUB 2900
2760 PRINT AT(35,5),CHR$(252),"ENER",CHR$(247),AT(35,6);
2770 N=S(4)
2780 GOSUB 2920
2790 PRINT AT(35,8),CHR$(252),"SHLD",CHR$(247),AT(35,9);
2800 N=S(5)
2810 GOSUB 2920
2820 PRINT AT(35,11),CHR$(252),"DAMG",CHR$(247),AT(35,12);
2830 N=S(6)
2840 GOSUB 2920
2850 PRINT AT(35,14),CHR$(252),"ENEM",CHR$(250),AT(35,15);
2860 N=S(0)
2870 GOSUB 2920
2880 PRINT AT(35,17),CHR$(252),"BASE",CHR$(254),AT(35,18);
2890 N=S(1)
2900 GOSUB 2920
2910 RETURN
2920 IF N<1000 THEN PRINT "0";
2930 IF N<100 THEN PRINT "0";
2940 IF N<10 THEN PRINT "0";
2950 PRINT N;
2960 RETURN
3000 REM INSTRUCTIONS
3010 PRINT CHR$(224,241,222,253)
3020 PRINT "INSTRUCTIONS"
3030 PRINT
3040 PRINT CHR$(241),"ORDERS"
3050 PRINT CHR$(252)
3060 PRINT CHR$(250),"DESTROY ALL ENEMY BATTLECRUISERS."
3070 PRINT CHR$(254),"PROTECT FEDERATED STARBASES."
3080 PRINT
3090 PRINT CHR$(241),"COMMANDS"
3100 PRINT
3110 PRINT CHR$(247),"NAV",CHR$(252)," NAVIGATE YOUR STARSHIP"
3120 PRINT CHR$(247),"SRS",CHR$(252)," SHORT RANGE SCAN"
3130 PRINT CHR$(247),"LRS",CHR$(252)," LONG RANGE SCAN"
3140 PRINT CHR$(247),"PHA",CHR$(252)," FIRE PHASER WEAPONS"
3150 PRINT CHR$(247),"SHI",CHR$(252)," RAISE AND LOWER SHIELDS"
3160 PRINT CHR$(247),"DAM",CHR$(252)," DAMAGE CONTROL"
3170 PRINT CHR$(247),"LOG",CHR$(252)," READ MISSION LOG"
3180 PRINT CHR$(247),"DOC",CHR$(252)," DOCK WITH STARBASE"
3190 PRINT CHR$(247),"BYE",CHR$(252)," RESIGN YOUR COMMAND"
3200 PRINT CHR$(252)
3210 RETURN
3300 REM CLEAR OUTPUT AREA
3310 PRINT CHR$(224,241);
3320 FOR Z(0)=20 TO 23
3330 PRINT AT(0,Z(0));
3340 FOR Z(1)=0 TO 39
3350 PRINT " ";
3360 NEXT
3370 NEXT
3380 PRINT AT(0,20),CHR$(252);
3390 RETURN
3400 REM INPUT COMMAND
3410 GOSUB 3300
3420 PRINT "COMMAND (H FOR HELP)";
3430 INPUT C$
3440 IF C$="H" THEN GOTO 3000
3450 IF C$="NAV" THEN GOTO 3800
3460 IF C$="SRS" THEN GOTO 2200
3470 IF C$="LRS" THEN GOTO 1900
3480 IF C$="PHA" THEN GOTO 4900
3490 IF C$="SHI" THEN GOTO 3600
3500 IF C$="DAM" THEN GOTO 4300
3510 IF C$="LOG" THEN GOTO 5700
3520 IF C$="DOC" THEN GOTO 4500
3530 IF C$="BYE" THEN GOTO 6200
3540 RETURN
3600 REM RAISE AND LOWER SHIELDS
3610 GOSUB 3300
3620 PRINT "NEW SHIELD LEVEL (0-1000)";
3630 INPUT L
3640 IF L<0 THEN L=0
3650 IF L>1000 THEN L=1000
3660 S(4)=S(4)+S(5)
3670 IF L>S(4) THEN L=S(4)
3680 S(4)=S(4)-L
3690 S(5)=L
3700 GOSUB 2200
3710 GOSUB 3300
3720 IF L=0 THEN PRINT "SHIELDS LOWERED."
3730 IF L>0 THEN PRINT "SHIELDS RAISED."
3740 GOSUB 9000
3750 RETURN
3800 REM NAVIGATION
3810 GOSUB 3300
3820 PRINT "DELTA X";
3830 INPUT X(0)
3840 PRINT "DELTA Y";
3850 INPUT Y(0)
3860 PRINT "WARP FACTOR (1-10)";
3870 INPUT F
3880 IF F<0 THEN F=1
3890 IF F>10 THEN F=10
3900 X(0)=X(0)+S(2)
3910 Y(0)=Y(0)+S(3)
3920 IF X(0)<0 THEN X(0)=0
3930 IF X(0)>63 THEN X(0)=63
3940 IF Y(0)<0 THEN Y(0)=0
3950 IF Y(0)>63 THEN Y(0)=63
3960 X(1)=S(2)
3970 Y(1)=S(3)
3980 GOSUB 8000
3990 E=A*F
4000 IF E<=S(4) THEN GOTO 4050
4010 GOSUB 330
4020 PRINT "INSUFFICIENT ENERGY."
4030 GOSUB 9000
4040 RETURN
4050 IF X(0)/8<>X(1)/8 THEN GOTO 4170
4060 IF Y(0)/8<>Y(1)/8 THEN GOTO 4170
4070 IF Q(MOD(X(0),8)+MOD(Y(0),8)*8)=0 THEN GOTO 4120
4080 GOSUB 3300
4090 PRINT "INVALID LOCATION."
4100 GOSUB 9000
4110 RETURN
4120 Q(MOD(X(0),8)+MOD(Y(0),8)*8)=4000
4130 Q(MOD(X(1),8)+MOD(Y(1),8)*8)=0
4140 GOSUB 4250
4150 GOSUB 2200
4160 RETURN
4170 GOSUB 4250
4180 GOSUB 1500
4190 GOSUB 2200
4200 GOSUB 3300
4210 GOSUB 1200
4220 PRINT "ENTERING ",S$,"...";
4230 GOSUB 9000
4240 RETURN
4250 S(2)=X(0)
4260 S(3)=Y(0)
4270 S(4)=S(4)-E
4280 S(7)=S(7)+A/F
4290 RETURN
4300 REM DAMAGE CONTROL
4310 GOSUB 3300
4320 PRINT "DAMAGE TO REPAIR (0-",S(6),")";
4330 INPUT D
4340 IF D<0 THEN D=0
4350 IF D>S(6) THEN D=S(6)
4360 IF D>S(4) THEN D=S(4)
4370 S(6)=S(6)-D
4380 S(4)=S(4)-D
4390 GOSUB 2200
4400 GOSUB 3300
4410 PRINT "REPAIRED ",D," DAMAGE POINTS.";
4420 GOSUB 9000
4430 RETURN
4500 REM DOCK WITH STARBASE
4510 IF S(5)=0 THEN GOTO 4560
4520 GOSUB 3300
4530 PRINT "CANNOT DOCK THROUGH SHIELDS.";
4540 GOSUB 9000
4550 RETURN
4560 GOSUB 3300
4570 S$="STARBASE"
4580 GOSUB 8100
4590 IF X(0)<0 THEN GOTO 4640
4600 IF Y(0)<0 THEN GOTO 4640
4610 I=X(0)+Y(0)*8
4620 IF Q(I)/1000=2 THEN GOTO 4670
4630 GOSUB 3300
4640 PRINT "NO STARBASE AT LOCATION.";
4650 GOSUB 9000
4660 RETURN
4670 X(1)=MOD(S(2),8)
4680 Y(1)=MOD(S(3),8)
4690 GOSUB 8000
4700 IF A<=1 THEN GOTO 4750
4710 GOSUB 3300
4720 PRINT "STARBASE OUT OF RANGE.";
4730 GOSUB 9000
4740 RETURN
4750 S(4)=3000
4760 GOSUB 2200
4770 GOSUB 3300
4780 PRINT "RESUPPLY COMPLETE.";
4790 GOSUB 9000
4800 RETURN
4900 REM FIRE PHASERS
4910 GOSUB 3300
4920 S$="TARGET"
4930 GOSUB 8100
4940 IF X(0)<0 THEN GOTO 5320
4950 IF Y(0)<0 THEN GOTO 5320
4960 GOSUB 3300
4970 PRINT "TARGET ENERGY (0-1000)";
4980 INPUT E
4990 IF E<S(4) THEN GOTO 5040
5000 GOSUB 3300
5010 PRINT "INSUFFICIENT ENERGY.";
5020 GOSUB 9000
5030 RETURN
5040 X(1)=MOD(S(2),8)
5050 Y(1)=MOD(S(3),8)
5060 GOSUB 8000
5070 D=E*2
5080 FOR I=1 TO A
5090 D=D/2
5100 NEXT
5110 I=X(0)+Y(0)*8
5120 T=Q(I)/1000
5130 IF T<1 THEN GOTO 5320
5140 IF T>3 THEN GOTO 5320
5150 GOSUB 3300
5160 PRINT "FIRING PHASERS..."
5170 GOSUB 7500
5180 M=MOD(Q(I),1000)-D
5190 S(4)=S(4)-E
5200 IF M<0 THEN M=0
5210 IF M=0 THEN GOTO 5280
5220 Q(I)=T*1000+M
5230 GOSUB 2200
5240 GOSUB 3300
5250 PRINT "HIT TARGET WITH ",D," UNITS.";
5260 GOSUB 9000
5270 RETURN
5280 Q(I)=0
5290 IF T=1 THEN GOTO 5400
5300 IF T=2 THEN GOTO 5500
5310 IF T=3 THEN GOTO 5600
5320 GOSUB 3300
5330 PRINT "NO TARGET AT LOCATION."
5340 GOSUB 9000
5350 RETURN
5400 S(0)=S(0)-1
5410 I=S(2)/8+S(3)/8*8
5420 G(I)=G(I)-100
5430 GOSUB 2200
5440 GOSUB 3300
5450 PRINT "ENEMY DESTROYED.";
5460 GOSUB 7700
5470 IF S(0)=0 THEN S(10)=0
5480 RETURN
5500 S(1)=S(1)-1
5510 I=S(2)/8+S(3)/8*8
5520 G(I)=G(I)-10
5530 GOSUB 2200
5540 GOSUB 3300
5550 PRINT "STARBASE DESTROYED.";
5560 GOSUB 7700
5570 RETURN
5600 I=S(2)/8+S(3)/8*8
5610 G(I)=G(I)-1
5620 GOSUB 2200
5630 GOSUB 3300
5640 PRINT "STAR GOES NOVA.";
5650 GOSUB 9000
5660 RETURN
5700 REM MISSION LOG
5710 PRINT CHR$(224,241,222,253)
5720 PRINT "MISSION LOG"
5730 PRINT
5740 GOSUB 5800
5750 RETURN
5800 REM MISSION SUMMARY
5810 IF S(6)>=1000 THEN PRINT CHR$(250),"STARSHIP DESTROYED!"
5820 PRINT CHR$(247),S(7)," STARDATES ELAPSED."
5830 PRINT CHR$(250),S(0)," OF ",S(8)," ENEMIES REMAINING."
5840 PRINT CHR$(254),S(1)," OF ",S(9)," STARBASES REMAINING."
5850 PRINT
5860 RETURN
5900 REM ENEMY ATTACKS
5910 IF G(S(2)/8+S(3)/8*8)/100=0 THEN RETURN 
5920 GOSUB 7100
5930 FOR X(0)=0 TO 7
5940 FOR Y(0)=0 TO 7
5950 IF Q(X(0)+Y(0)*8)/1000=1 THEN GOSUB 6000
5960 NEXT
5970 NEXT
5980 RETURN
6000 GOSUB 3300
6010 PRINT CHR$(250),"ENEMY AT ",X(0),",",Y(0)," ATTACKING..."
6020 X(1)=MOD(S(2),8)
6030 Y(1)=MOD(S(3),8)
6040 GOSUB 8000
6050 E=MOD(RND(),4)*100+400
6060 D=E*2
6070 FOR I=1 TO A
6080 D=D/2
6090 NEXT
6100 D=D/4
6110 S(5)=S(5)-D*3
6120 S(6)=S(6)+D
6130 IF S(5)<0 THEN S(6)=S(6)-S(5)
6140 IF S(5)<0 THEN PRINT CHR$(247),"SHIELDS COLLAPSED!"
6150 IF S(5)<0 THEN S(5)=0
6160 IF S(6)>=1000 THEN S(10)=0
6170 GOSUB 7300
6180 GOSUB 2700
6190 RETURN
6200 REM RESIGN COMMAND
6210 GOSUB 3300
6220 PRINT "RESIGN COMMAND (Y/N)";
6230 INPUT C$
6240 IF C$="Y" THEN S(10)=0
6250 RETURN
7000 REM SOUND OFF
7010 FOR Z=0 TO 6
7020 POKE 54272+I,0
7030 NEXT
7040 POKE 54296,14
7050 RETURN
7100 REM RED ALERT
7110 GOSUB 7000
7120 POKE 54272,0
7130 POKE 54273,20
7140 POKE 54277,176
7150 POKE 54278,249
7160 FOR I=1 TO 3
7170 POKE 54276,33
7180 POKE 53250,OR(AND(PEEK(53250),240),2)
7190 Z=TI
7200 IF ABS(Z-TI)<60 THEN GOTO 7200
7210 POKE 54276,32
7220 POKE 53250,AND(PEEK(53250),240)
7230 Z=TI
7240 IF ABS(Z-TI)<60 THEN GOTO 7240
7250 NEXT
7260 GOSUB 7000
7270 RETURN
7300 REM EXPLOSION
7310 GOSUB 7000
7320 POKE 54272,0
7330 POKE 54273,20
7340 POKE 54277,0
7350 POKE 54278,186
7360 POKE 54276,129
7370 Z=TI
7380 POKE 54276,128
7390 POKE 53249,OR(PEEK(53249),6)
7400 POKE 53252,RND()
7410 IF ABS(Z-TI)<90 THEN GOTO 7400
7420 POKE 53249,AND(PEEK(53249),249)
7430 POKE 54276,0
7440 POKE 54308,0
7450 GOSUB 7000
7460 RETURN
7500 REM PHASER
7510 GOSUB 7000
7520 POKE 54272,0
7530 POKE 54273,40
7540 POKE 54275,8
7550 POKE 54276,0
7560 POKE 54277,0
7570 POKE 54278,192
7580 POKE 54276,65
7590 POKE 53250,OR(AND(PEEK(53250),240),7)
7600 Z=TI
7610 POKE 54272,RND()
7620 IF ABS(Z-TI)<60 THEN GOTO 7610
7630 POKE 54276,0
7640 POKE 53250,AND(PEEK(53250),240)
7650 GOSUB 7000
7660 RETURN
7700 REM DESTROYED FX
7710 GOSUB 7000
7720 POKE 54272,0
7730 POKE 54273,10
7740 POKE 54277,192
7750 POKE 54278,250
7760 POKE 54276,129
7770 Z=TI
7780 IF ABS(Z-TI)<60 THEN GOTO 7780
7790 POKE 54276,128
7800 Z=TI
7810 IF ABS(Z-TI)<120 THEN GOTO 7810
7820 GOSUB 7000
7830 RETURN
8000 REM DISTANCE FORMULA
8010 Z(0)=ABS(X(0)-X(1))
8020 Z(1)=ABS(Y(0)-Y(1))
8030 A=SQR(Z(0)*Z(0)+Z(1)*Z(1))
8040 RETURN
8100 REM INPUT SECTOR COORDS
8110 PRINT S$," X (0-7)";
8120 INPUT X(0)
8130 PRINT S$," Y (0-7)";
8140 INPUT Y(0)
8150 IF X(0)<0 THEN X(0)=-1
8160 IF X(0)>7 THEN X(0)=-1
8170 IF Y(0)<0 THEN Y(0)=-1
8180 IF Y(0)>7 THEN Y(0)=-1
8190 RETURN
9000 REM DELAY WITH BEEP
9010 GOSUB 7000
9020 POKE 54272,0
9030 POKE 54273,30
9040 POKE 54275,8
9050 POKE 54276,0
9060 POKE 54277,0
9070 POKE 54278,192
9080 POKE 54276,65
9090 Z=TI
9100 IF TI-Z<30 THEN GOTO 9100
9110 POKE 54276,64
9120 GOSUB 7000
9130 RETURN

