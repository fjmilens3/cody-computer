10 REM CODY LANDER 1.0 BY FJ MILENS III
20 REM RELEASED UNDER GPL V3, DEC 2024
30 A=14000
40 F=1200
50 V=0
60 G=-5
70 Y=3
80 B=0
90 E=0
100 REM MAIN PROGRAM
110 POKE 53250,AND(PEEK(53250),240)
120 GOSUB 7000
130 PRINT CHR$(253,224,222)
140 GOSUB 3000
150 GOSUB 2000
160 GOSUB 4000
170 GOSUB 1000
180 F=F-B
190 V=V+G+B
200 A=A+V
210 E=E+1
220 T=TI
230 IF TI-T<60 THEN GOTO 230
240 GOSUB 9000
250 GOSUB 8300
260 GOSUB 8000
270 IF A>20 THEN GOTO 180
280 A=0
290 B=0
300 L=30
310 IF V<=-30 THEN L=0
320 GOSUB 9000
330 GOSUB 8300
340 GOSUB 6000
350 IF V>-30 THEN GOSUB 6100
360 IF V<=-30 THEN GOSUB 6200
370 PRINT AT(0,24),CHR$(241),"PLAY AGAIN (Y/N)";
380 INPUT Z$
390 IF Z$="Y" THEN GOTO 10
400 IF Z$="N" THEN END
410 GOTO 370
1000 REM DRAW LUNAR LANDER
1010 PRINT AT(18,Y),CHR$(252,20,20,170,193);
1020 PRINT AT(18,Y+1),CHR$(255,20,223,172,20,162,223);
1030 PRINT AT(18,Y+2),CHR$(255,20,223,20,193,20,223);
1040 PRINT AT(18,Y+3),CHR$(247,223,172,85,83,65,162,223);
1050 PRINT AT(18,Y+4),CHR$(247,145,252,223,172,165,162,223,247,144);
1060 RETURN
2000 REM DRAW DISPLAY BOX
2010 PRINT CHR$(252);
2020 PRINT AT(0,1),CHR$(173,223),"SPEED HEIGHT",CHR$(223,168);
2030 FOR I=0 TO 2
2040 PRINT AT(0,2+I),CHR$(173),"            ",CHR$(168);
2050 NEXT
2060 PRINT AT(0,5),CHR$(173,223)," FUEL  TIME ",CHR$(223,168);
2070 FOR I=0 TO 1
2080 PRINT AT(0,6+I),CHR$(173),"            ",CHR$(168);
2090 NEXT
2100 PRINT AT(0,8),CHR$(173);
2110 FOR I=0 TO 11
2120 PRINT CHR$(167);
2130 NEXT
2140 PRINT CHR$(168);
2150 RETURN
3000 REM DRAW STARS
3010 Z=RND(20)
3020 PRINT CHR$(241);
3030 FOR I=0 TO 11
3040 PRINT AT(MOD(RND(),39), MOD(RND(),20)),".";
3050 NEXT
3060 RETURN
4000 REM DRAW LUNAR SURFACE
4010 PRINT CHR$(236),AT(0,21);
4020 FOR I=0 TO 3
4030 PRINT "          ";
4040 NEXT
4050 PRINT CHR$(224,252),AT(0,20);
4060 FOR I=0 TO 3
4070 PRINT CHR$(167,167,188,188,165,188,188,165,165,188);
4080 NEXT
4090 PRINT AT(16,20);
4100 PRINT CHR$(188,167,20,20,20,20,20,167,188);
4110 RETURN
5000 REM DELETE LUNAR LANDER
5010 FOR I=0 TO 4
5020 PRINT AT(18,Y+I),"     ";
5030 NEXT
5040 RETURN
6000 REM LANDING ANIMATION
6010 FOR Y=3 TO 16
6020 GOSUB 1000
6030 T=TI
6040 IF TI-T<L THEN GOTO 6040
6050 GOSUB 5000
6060 NEXT
6070 GOSUB 1000
6080 RETURN
6100 REM LANDED
6110 PRINT CHR$(241);
6120 PRINT AT(0,23),CHR$(34),"HOUSTON...",CHR$(34);
6130 T=TI
6140 IF TI-T<120 THEN GOTO 6140
6150 PRINT AT(0,23),CHR$(34),"THE POMERANIAN HAS LANDED!",CHR$(34);
6160 T=TI
6170 IF TI-T<600 THEN GOTO 6170
6180 RETURN
6200 REM CRASHED
6210 GOSUB 5000
6220 PRINT AT(18,20),CHR$(251,171,169,169,171,171);
6230 PRINT AT(0,23),CHR$(241),"YOU CRASHED!"
6240 T=TI
6250 IF TI-T<600 THEN GOTO 6250
6260 RETURN
7000 REM INSTRUCTIONS
7010 PRINT CHR$(224,222)
7020 PRINT CHR$(253),"1973",CHR$(241)
7030 PRINT
7040 PRINT "THE LUNAR LANDER",CHR$(247)," POMERANIAN ",CHR$(241),"HAS JUST"
7050 PRINT "UNDOCKED FROM ITS APOLLO CAPSULE. IT"
7060 PRINT "IS DESCENDING TO",CHR$(247)," MARE CRISIUM ",CHR$(241),", THE SEA"
7070 PRINT "OF CRISES",CHR$(241),". ABOARD ARE YOURSELF AS THE"
7080 PRINT "COMMANDER AND AN ASTRONAUT-SCIENTIST."
7090 PRINT
7100 PRINT "GRAVITY IS PULLING YOU DOWNWARD AT A"
7110 PRINT "RATE OF 5 UNITS PER SECOND. YOU MUST "
7120 PRINT "FIRE YOUR THRUSTER TO ENSURE A SOFT "
7130 PRINT "LANDING AT NO MORE THAN 30 UNITS PER "
7140 PRINT "SECOND. EACH UNIT OF FUEL EQUATES TO "
7150 PRINT "ONE UNIT OF THRUST. KEYS 1 TO 0 WILL "
7160 PRINT "FIRE THE THRUSTER AT A LEVEL FROM 1 "
7170 PRINT "TO 10."
7180 PRINT
7190 PRINT "GOOD LUCK. WE'RE ALL COUNTING ON YOU."
7200 PRINT CHR$(247)
7210 PRINT AT(0,23),"DO YOU UNDERSTAND (Y/N)";
7220 INPUT C$
7230 IF C$<>"Y" THEN GOTO 7000
7240 RETURN
8000 REM GET BURN COMMAND
8010 B=0
8020 Z=PEEK(16)
8030 IF Z=30 THEN B=1
8040 IF Z=29 THEN B=3
8050 IF Z=27 THEN B=5
8060 IF Z=23 THEN B=7
8070 IF Z=15 THEN B=9
8080 Z=PEEK(21)
8090 IF Z=30 THEN B=2
8100 IF Z=29 THEN B=4
8110 IF Z=27 THEN B=6
8120 IF Z=23 THEN B=8
8130 IF Z=15 THEN B=10
8140 RETURN
8300 REM DRAW BURN
8310 PRINT CHR$(240);
8320 FOR I=1 TO 10
8330 PRINT AT(19,Y+5+I),"   ";
8340 NEXT
8350 IF B=0 THEN RETURN
8360 FOR I=1 TO B
8370 PRINT CHR$(250);
8380 IF I>3 THEN PRINT CHR$(248);
8390 IF I>6 THEN PRINT CHR$(247);
8400 PRINT AT(19,Y+5+I),CHR$(145,186,144);
8410 NEXT
8420 RETURN
9000 REM DRAW DISPLAY
9010 PRINT CHR$(253);
9020 PRINT AT(1,3);
9030 N=V
9040 IF N>0 THEN PRINT CHR$(223);
9050 GOSUB 9200
9060 IF N>0 THEN PRINT CHR$(223);
9070 PRINT AT(7,3);
9080 N=A
9090 GOSUB 9200
9100 PRINT AT(1,7);
9110 N=F
9120 GOSUB 9200
9130 PRINT AT(7,7);
9140 N=E
9150 GOSUB 9200
9160 RETURN
9200 REM DISPLAY NUMBER
9210 Z=ABS(N)
9220 IF Z<10000 THEN PRINT " ";
9230 IF Z<1000 THEN PRINT " ";
9240 IF Z<100 THEN PRINT " ";
9250 IF Z<10 THEN PRINT " ";
9260 PRINT Z;
9270 RETURN

